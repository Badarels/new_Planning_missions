<main id="main" class="main">
    <div class="pagetitle">
        <h1>Liste des utilisateurs</h1>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a [routerLink]="'/Accueil/accueil'">ACCUEIL</a></li>
                <li class="breadcrumb-item">Liste</li>
            </ol>
        </nav>
    </div><!-- End Page Title -->

    <section class="section">
        <!-- Content body start -->
        <div class="content-body">
            <!-- row -->
            <div class="container-fluid">       
                <div class="row">
                    <div class="col-lg-12">
                        <ul class="nav nav-pills mb-3">
                            <li class="nav-item"><a href="#list-view" data-toggle="tab" class="nav-link btn-primary mr-1 show active">Vue Liste</a></li>
                            <li class="nav-item"><a href="#grid-view" data-toggle="tab" class="nav-link btn-primary">Vue Grille</a></li>
                            <li class="nav-item"><a  data-toggle="tab" class="nav-link btn-primary" [routerLink]="'/ajoutUtilisateur/ajout'">+ Ajouter nouveau</a></li>

                        </ul>
                    </div>
                    <div class="col-lg-12">
                        <div class="row tab-content">
                            <div id="list-view" class="tab-pane fade active show col-lg-12">
                                <div class="card">
                                    <div class="card-body">
                                      <h2 class="card-title">Utilisateurs</h2>              
                                      <!-- Formulaire de recherche à droite avec une taille md-5 -->
                                      <div class="col-md-4 col-lg-4 offset-md-8 justify-content-md-end">
                                        <form class="form-inline mb-3 ml-auto">
                                          <div class="form-group mx-md-2 mb-2">
                                            <div class="input-group">
                                              <input class="form-control with-blue-border fas fa-search" type="search" placeholder="Rechercher" [(ngModel)]="filtreText" aria-label="Search" name="filtreText">
                                              <div class="input-group-append">
                                                <span class="input-group-text"><i class="fas fa-search fa-recherche"></i></span>
                                              </div>
                                            </div>  
                                          </div>
                                        </form>
                                      </div> 
                                      <div class="table-responsive user_card">
                                      <!-- Tableau avec des lignes rayées -->
                                      <table class="table datatable">
                                        <thead>
                                          <tr>
                                            <th scope="col" style="width: 900px;">Nom</th>
                                            <th scope="col" style="width: 200px;">Prenom</th>
                                            <th scope="col" style="width: 600px;">Adresse</th>
                                            <th scope="col" style="width: 200px;">Sexe</th>
                                            <th scope="col" style="width: 800px;">Date de Naissance</th>
                                            <th scope="col" style="width: 200px;">Email</th>  
                                            <th scope="col" style="width: 200px;">Telephone</th>
                                            <th scope="col" style="width: 200px;">N° piece d'indentité</th>
                                            <th scope="col" style="width: 200px;">Role</th>
                                            <th scope="col" style="width: 200px;">Action</th>
                                        </tr>
                                       </thead> 
                                        <tbody>
                                        <tr *ngFor="let user of users | users: filtreText;">
                                            <!-- Contenu de la ligne -->
                                            <td>{{user?.nomUser}}</td>
                                            <td>{{user?.prenomUser}}</td>
                                            <td>{{user?.adresseUser}}</td>
                                            <td>{{user?.sexeUser}}</td>
                                            <td>{{user?.dateNaissanceUser}}</td>
                                            <td>{{user?.emailUser}}</td>
                                            <td>{{user?.telephoneUser}}</td>    
                                            <td>{{user?.numeroPieceIdentiteUser}}</td>
                                            <td>{{user?.roles?.nomRoles}}</td>
                                            <td>
                                              <div ngbDropdown class="d-inline-block">
                                                <button class="btn btn-light buttonMenu d-inline-flex align-items-start" id="dropdownMenuButton" ngbDropdownToggle>
                                                    <i class="bi bi-three-dots-vertical"></i>
                                                </button>
                                                <div ngbDropdownMenu [ngClass]="{'show': isDropdownOpen}" aria-labelledby="dropdownMenuButton">
                                                  <!-- Utilisez [routerLink] pour "Modifier" et (click) pour "Supprimer" -->
                                                  
                                                  <button class="dropdown-item" [routerLink]="['/ProfilUtilisateur/profil', user?.id]">Aperçue</button>
                                                  <button class="dropdown-item" [routerLink]="['/ModifierUtilisateur/edit', user?.id]">Modifier</button>
                                                  <button class="dropdown-item" (click)="supprimerUsers($event, user?.id)">Supprimer</button>
                                                </div> 
                                              </div>
                                            </td>
                                        </tr>
                                        </tbody>
                                      </table>
                                      <!-- Fin du tableau avec des lignes rayées -->
                                    </div>
                                    </div>
                                  </div>
                            </div>
                            <div id="grid-view" class="tab-pane fade col-lg-12">
                                <div class="row">
                              
                                    <div class="col-lg-4 col-md-6 col-sm-6 col-12" *ngFor="let user of users">
                                        <div class="card card-profile">
                                          <div class="card-header justify-content-end pb-1">
                                            <div ngbDropdown class="d-inline-flex col-offset-4 ml-auto align-items-center justify-content-end" style="position: relative;">
                                              <button class="btn btn-light buttonMenu gridUserbtnmenu float-right" id="dropdownMenuButton" style="font-size: 12px; background-color: white; border: 1px 1cap grey;" ngbDropdownToggle>
                                                <i class="bi bi-three-dots"></i>
                                            </button>                                            
                               
                                              <div ngbDropdownMenu [ngClass]="{'show': isDropdownOpen}" aria-labelledby="dropdownMenuButton">
                                                  <!-- Utilisez [routerLink] pour "Modifier" et (click) pour "Supprimer" -->
                                                  <button class="dropdown-item" [routerLink]="['/ModifierUtilisateur', user?.id]">Modifier</button>
                                                  <button class="dropdown-item" (click)=" supprimerUsers($event, user?.id)">Supprimer</button>
                                              </div>
                                          </div>
                                          
                                          </div>
                                
                                            <div class="card-body pt-2">
                                                <div class="text-center">
                                                    <div class="profile-photo">
                                                        <img src="images/profile/small/pic2.jpg" width="100" class="img-fluid rounded-circle" alt="">
                                                    </div>
                                                    <h3 class="mt-4 mb-1">{{user?.nomUser}}</h3>
                                                    <p class="text-muted">{{user?.prenomUser}}</p>
                                                    <ul class="list-group mb-3 list-group-flush">
                                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                                            <span>Role :</span><strong>{{user?.roles?.nomRoles}}</strong></li>
                                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                                            <span class="mb-0">N° Téléphone :</span><strong>{{user?.telephoneUser}}</strong>
                                                        </li>
                                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                                            <span class="mb-0">Adresse :</span><strong>{{user?.adresseUser}}</strong>
                                                        </li>
                                                        <li class="list-group-item px-0 d-flex justify-content-between">
                                                            <span class="mb-0">Email:</span><strong>{{user?.emailUser}}</strong></li>
                                                    </ul>
                                                    <a class="btn btn-outline-primary btn-rounded mt-3 px-4" [routerLink]="['/ProfilUtilisateur', user?.id]">Aperçu</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>  
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>
